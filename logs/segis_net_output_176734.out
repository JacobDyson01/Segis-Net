Construct model
src_segm shape: (?, 144, 96, 112, 3)
y shape: (?, 144, 96, 112, 1)
nonr_def shape: (?, 144, 96, 112, 3)
all_def shape: (?, 144, 96, 112, 3)
tgt_segm shape: (?, 144, 96, 112, 3)
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 144, 96, 112, 0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 144, 96, 112, 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 144, 96, 112, 0                                            
__________________________________________________________________________________________________
model_2 (Model)                 [(None, 144, 96, 112 4707067     input_1[0][0]                    
                                                                 input_2[0][0]                    
                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 144, 96, 112, 0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 144, 96, 112, 5889325     input_3[0][0]                    
__________________________________________________________________________________________________
nonr_def (Lambda)               (None, 144, 96, 112, 0           model_2[1][1]                    
__________________________________________________________________________________________________
srcSegm (Lambda)                (None, 144, 96, 112, 0           model_1[1][0]                    
__________________________________________________________________________________________________
add_2 (Add)                     (None, 144, 96, 112, 0           nonr_def[0][0]                   
                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
warpedSrc (Lambda)              (None, 144, 96, 112, 0           model_2[1][0]                    
__________________________________________________________________________________________________
movedSegm (SpatialTransformer)  [(None, 144, 96, 112 0           srcSegm[0][0]                    
                                                                 add_2[0][0]                      
==================================================================================================
Total params: 10,596,392
Trainable params: 10,590,532
Non-trainable params: 5,860
__________________________________________________________________________________________________
train a new model!
train with 1 GPU
Epoch 1/300
affine min: -1.4987266063690186, max: 1.6377816200256348
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 3)
affine min: -2.365302085876465, max: 2.643362283706665
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 3)
affine min: -1.9242477416992188, max: 1.5687464475631714
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 3)
affine min: -1.9801617860794067, max: 3.8721625804901123
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 3)
affine min: -1.481819987297058, max: 1.329351782798767
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 3)
affine min: -1.5253995656967163, max: 1.5067497491836548
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 3)
affine min: -1.6957831382751465, max: 1.5439441204071045
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 3)
affine min: -2.2370212078094482, max: 0.9756510257720947
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 3)
affine min: -1.5165075063705444, max: 1.555708646774292
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 3)
affine min: -2.0791664123535156, max: 2.1982545852661133
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 3)
affine min: -1.4796605110168457, max: 2.495893716812134
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 3)
