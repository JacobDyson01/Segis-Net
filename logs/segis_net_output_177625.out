Construct model
src_segm shape: (?, 144, 96, 112, 3)
y shape: (?, 144, 96, 112, 1)
nonr_def shape: (?, 144, 96, 112, 3)
tgt_segm shape: (?, 144, 96, 112, 3)
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 144, 96, 112, 0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 144, 96, 112, 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 144, 96, 112, 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 144, 96, 112, 0                                            
__________________________________________________________________________________________________
model_2 (Model)                 [(None, 144, 96, 112 4707067     input_1[0][0]                    
                                                                 input_2[0][0]                    
                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
model_1 (Model)                 (None, 144, 96, 112, 5889325     input_3[0][0]                    
__________________________________________________________________________________________________
srcSegm (Lambda)                (None, 144, 96, 112, 0           model_1[1][0]                    
__________________________________________________________________________________________________
nonr_def (Lambda)               (None, 144, 96, 112, 0           model_2[1][1]                    
__________________________________________________________________________________________________
warpedSrc (Lambda)              (None, 144, 96, 112, 0           model_2[1][0]                    
__________________________________________________________________________________________________
movedSegm (SpatialTransformer)  [(None, 144, 96, 112 0           srcSegm[0][0]                    
                                                                 nonr_def[0][0]                   
==================================================================================================
Total params: 10,596,392
Trainable params: 10,590,532
Non-trainable params: 5,860
__________________________________________________________________________________________________
train a new model!
train with 1 GPU
Epoch 1/300
affine min: 0.0, max: 129.3429718017578
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 123.61847686767578
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 122.41776275634766
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 130.68252563476562
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 124.52397918701172
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 124.32431030273438
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 122.51236724853516
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 122.23265075683594
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 127.43836975097656
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 125.74767303466797
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 127.63117980957031
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 140.1510772705078
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 119.89848327636719
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 121.42423248291016
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 116.26301574707031
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 122.56172180175781
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 122.51763916015625
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 119.12646484375
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 128.2387237548828
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 118.16696166992188
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 124.5113296508789
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 121.73023986816406
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 120.59247589111328
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 124.49322509765625
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 132.42428588867188
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 116.22254943847656
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 156.8499755859375
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 148.77102661132812
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 121.27332305908203
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 121.92542266845703
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 123.64976501464844
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 158.89744567871094
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 168.98609924316406
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 125.55381774902344
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 164.810546875
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 120.93348693847656
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 136.92347717285156
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 121.64763641357422
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 123.69461822509766
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 126.56449890136719
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 124.34178161621094
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 120.14934539794922
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 120.29960632324219
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 119.0069808959961
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)

 1/17 [>.............................] - ETA: 4:55:51 - loss: 1510.7570 - warpedSrc_loss: 151.0834 - movedSegm_loss: -0.0388 - srcSegm_loss: -0.0379 - nonr_def_loss: 4.3781e-09 - warpedSrc_MeanSquaredError: 151.0834 - movedSegm_sigmoid_sftDC: 0.0378 - srcSegm_sigmoid_DC: 0.0369 - nonr_def_mean_absolute_error: 6.4861e-05affine min: 0.0, max: 129.3511962890625
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 123.65695190429688
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 119.44468688964844
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 165.52626037597656
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)

 2/17 [==>...........................] - ETA: 4:34:39 - loss: 1021.5228 - warpedSrc_loss: 102.1629 - movedSegm_loss: -0.0534 - srcSegm_loss: -0.0530 - nonr_def_loss: 1.3592e-04 - warpedSrc_MeanSquaredError: 102.1629 - movedSegm_sigmoid_sftDC: 0.0696 - srcSegm_sigmoid_DC: 0.0686 - nonr_def_mean_absolute_error: 0.0316    affine min: 0.0, max: 121.83629608154297
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 120.91606903076172
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 168.5893096923828
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)
affine min: 0.0, max: 118.56330871582031
tensor shape: (144, 96, 112, 1)
segm1 shape: (144, 96, 112, 1)
segm2 shape: (144, 96, 112, 1)
tgt_img shape: (144, 96, 112, 1)
src_img shape: (144, 96, 112, 1)
aff_def shape: (144, 96, 112, 1)

 3/17 [====>.........................] - ETA: 4:15:12 - loss: 820.4387 - warpedSrc_loss: 82.0563 - movedSegm_loss: -0.0629 - srcSegm_loss: -0.0619 - nonr_def_loss: 2.7843e-04 - warpedSrc_MeanSquaredError: 82.0563 - movedSegm_sigmoid_sftDC: 0.0905 - srcSegm_sigmoid_DC: 0.0880 - nonr_def_mean_absolute_error: 0.0556   