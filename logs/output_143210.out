Construct model
src_segm shape: (?, 112, 208, 112, 3)
y shape: (?, 112, 208, 112, 1)
nonr_def shape: (?, 112, 208, 112, 3)
all_def shape: (?, 112, 208, 112, 3)
tgt_segm shape: (?, 112, 208, 112, 3)
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 112, 208, 112 0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 112, 208, 112 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 112, 208, 112 0                                            
__________________________________________________________________________________________________
model_2 (Model)                 [(None, 112, 208, 11 4707067     input_1[0][0]                    
                                                                 input_2[0][0]                    
                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 112, 208, 112 0                                            
__________________________________________________________________________________________________
model_1 (Model)                 (None, 112, 208, 112 5889325     input_3[0][0]                    
__________________________________________________________________________________________________
nonr_def (Lambda)               (None, 112, 208, 112 0           model_2[1][1]                    
__________________________________________________________________________________________________
srcSegm (Lambda)                (None, 112, 208, 112 0           model_1[1][0]                    
__________________________________________________________________________________________________
add_2 (Add)                     (None, 112, 208, 112 0           nonr_def[0][0]                   
                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
warpedSrc (Lambda)              (None, 112, 208, 112 0           model_2[1][0]                    
__________________________________________________________________________________________________
movedSegm (SpatialTransformer)  [(None, 112, 208, 11 0           srcSegm[0][0]                    
                                                                 add_2[0][0]                      
==================================================================================================
Total params: 10,596,392
Trainable params: 10,590,532
Non-trainable params: 5,860
__________________________________________________________________________________________________
train a new model!
train with 1 GPU
Epoch 1/300
/home/groups/dlmrimnd/jacob/data_temp/input_images/sub-129S6459_ses-01_ses-02/target.nii.gz
affine min: 0.0, max: 192.66566467285156
/home/groups/dlmrimnd/jacob/data_temp/input_images/sub-035S6488_ses-01_ses-03/target.nii.gz
affine min: 0.0, max: 125.57781982421875
/home/groups/dlmrimnd/jacob/data_temp/input_images/sub-014S6145_ses-02_ses-03/target.nii.gz
affine min: 0.0, max: 207.0
/home/groups/dlmrimnd/jacob/data_temp/input_images/sub-126S6559_ses-01_ses-02/target.nii.gz
affine min: 0.0, max: 170.05303955078125
/home/groups/dlmrimnd/jacob/data_temp/input_images/sub-141S6008_ses-03_ses-04/target.nii.gz
affine min: 0.0, max: 180.2099609375
/home/groups/dlmrimnd/jacob/data_temp/input_images/sub-027S6183_ses-01_ses-02/target.nii.gz
affine min: 0.0, max: 207.0
/home/groups/dlmrimnd/jacob/data_temp/input_images/sub-014S6437_ses-01_ses-02/target.nii.gz
affine min: 0.0, max: 207.0
/home/groups/dlmrimnd/jacob/data_temp/input_images/sub-114S6487_ses-01_ses-02/target.nii.gz
affine min: 0.0, max: 201.4793243408203
/home/groups/dlmrimnd/jacob/data_temp/input_images/sub-014S6145_ses-01_ses-03/target.nii.gz
affine min: 0.0, max: 123.36651611328125
/home/groups/dlmrimnd/jacob/data_temp/input_images/sub-099S6175_ses-01_ses-03/target.nii.gz
affine min: 0.0, max: 207.0
/home/groups/dlmrimnd/jacob/data_temp/input_images/sub-020S6185_ses-01_ses-03/target.nii.gz
affine min: 0.0, max: 207.0
