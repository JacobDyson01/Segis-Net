Construct model
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 144, 96, 112, 0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 144, 96, 112, 0                                            
__________________________________________________________________________________________________
input_4 (InputLayer)            (None, 144, 96, 112, 0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 144, 96, 112, 0                                            
__________________________________________________________________________________________________
model_2 (Model)                 [(None, 144, 96, 112 4707067     input_1[0][0]                    
                                                                 input_2[0][0]                    
                                                                 input_4[0][0]                    
__________________________________________________________________________________________________
model_1 (Model)                 (None, 144, 96, 112, 5888449     input_3[0][0]                    
__________________________________________________________________________________________________
srcSegm (Lambda)                (None, 144, 96, 112, 0           model_1[1][0]                    
__________________________________________________________________________________________________
nonr_def (Lambda)               (None, 144, 96, 112, 0           model_2[1][1]                    
__________________________________________________________________________________________________
warpedSrc (Lambda)              (None, 144, 96, 112, 0           model_2[1][0]                    
__________________________________________________________________________________________________
movedSegm (SpatialTransformer)  [(None, 144, 96, 112 0           srcSegm[0][0]                    
                                                                 nonr_def[0][0]                   
==================================================================================================
Total params: 10,595,516
Trainable params: 10,589,660
Non-trainable params: 5,856
__________________________________________________________________________________________________
train a new model!
train with 1 GPU
Epoch 1/100

 1/17 [>.............................] - ETA: 4:32:50 - loss: 0.3042 - warpedSrc_loss: 0.0817 - movedSegm_loss: -0.0349 - srcSegm_loss: -0.0345 - nonr_def_loss: 5.0084e-09 - warpedSrc_MeanSquaredError: 0.0817 - movedSegm_sigmoid_sftDC: 0.0294 - srcSegm_sigmoid_DC: 0.0291 - nonr_def_mean_absolute_error: 6.8253e-05
 2/17 [==>...........................] - ETA: 4:13:30 - loss: 0.2550 - warpedSrc_loss: 0.0810 - movedSegm_loss: -0.0501 - srcSegm_loss: -0.0500 - nonr_def_loss: 2.6195e-05 - warpedSrc_MeanSquaredError: 0.0810 - movedSegm_sigmoid_sftDC: 0.0557 - srcSegm_sigmoid_DC: 0.0559 - nonr_def_mean_absolute_error: 0.0103    
 3/17 [====>.........................] - ETA: 3:55:56 - loss: 0.2659 - warpedSrc_loss: 0.0877 - movedSegm_loss: -0.0576 - srcSegm_loss: -0.0575 - nonr_def_loss: 6.9334e-05 - warpedSrc_MeanSquaredError: 0.0877 - movedSegm_sigmoid_sftDC: 0.0691 - srcSegm_sigmoid_DC: 0.0692 - nonr_def_mean_absolute_error: 0.0215
 4/17 [======>.......................] - ETA: 3:38:43 - loss: 0.2189 - warpedSrc_loss: 0.0828 - movedSegm_loss: -0.0647 - srcSegm_loss: -0.0653 - nonr_def_loss: 1.1871e-04 - warpedSrc_MeanSquaredError: 0.0828 - movedSegm_sigmoid_sftDC: 0.0858 - srcSegm_sigmoid_DC: 0.0866 - nonr_def_mean_absolute_error: 0.0300
 5/17 [=======>......................] - ETA: 3:21:48 - loss: 0.1880 - warpedSrc_loss: 0.0798 - movedSegm_loss: -0.0701 - srcSegm_loss: -0.0705 - nonr_def_loss: 1.8573e-04 - warpedSrc_MeanSquaredError: 0.0798 - movedSegm_sigmoid_sftDC: 0.0992 - srcSegm_sigmoid_DC: 0.0997 - nonr_def_mean_absolute_error: 0.0374
 6/17 [=========>....................] - ETA: 3:04:58 - loss: 0.1191 - warpedSrc_loss: 0.0689 - movedSegm_loss: -0.0753 - srcSegm_loss: -0.0751 - nonr_def_loss: 2.4121e-04 - warpedSrc_MeanSquaredError: 0.0689 - movedSegm_sigmoid_sftDC: 0.1128 - srcSegm_sigmoid_DC: 0.1121 - nonr_def_mean_absolute_error: 0.0454
 7/17 [===========>..................] - ETA: 2:48:07 - loss: 0.1007 - warpedSrc_loss: 0.0667 - movedSegm_loss: -0.0777 - srcSegm_loss: -0.0776 - nonr_def_loss: 2.8122e-04 - warpedSrc_MeanSquaredError: 0.0667 - movedSegm_sigmoid_sftDC: 0.1231 - srcSegm_sigmoid_DC: 0.1226 - nonr_def_mean_absolute_error: 0.0523
 8/17 [=============>................] - ETA: 2:31:16 - loss: 0.0754 - warpedSrc_loss: 0.0639 - movedSegm_loss: -0.0813 - srcSegm_loss: -0.0813 - nonr_def_loss: 3.0970e-04 - warpedSrc_MeanSquaredError: 0.0639 - movedSegm_sigmoid_sftDC: 0.1377 - srcSegm_sigmoid_DC: 0.1373 - nonr_def_mean_absolute_error: 0.0571
 9/17 [==============>...............] - ETA: 2:14:26 - loss: 0.0750 - warpedSrc_loss: 0.0651 - movedSegm_loss: -0.0835 - srcSegm_loss: -0.0835 - nonr_def_loss: 3.3260e-04 - warpedSrc_MeanSquaredError: 0.0651 - movedSegm_sigmoid_sftDC: 0.1495 - srcSegm_sigmoid_DC: 0.1489 - nonr_def_mean_absolute_error: 0.0603
10/17 [================>.............] - ETA: 1:57:37 - loss: 0.0564 - warpedSrc_loss: 0.0630 - movedSegm_loss: -0.0863 - srcSegm_loss: -0.0861 - nonr_def_loss: 3.5888e-04 - warpedSrc_MeanSquaredError: 0.0630 - movedSegm_sigmoid_sftDC: 0.1607 - srcSegm_sigmoid_DC: 0.1595 - nonr_def_mean_absolute_error: 0.0629
11/17 [==================>...........] - ETA: 1:40:48 - loss: 0.0368 - warpedSrc_loss: 0.0604 - movedSegm_loss: -0.0885 - srcSegm_loss: -0.0882 - nonr_def_loss: 3.8369e-04 - warpedSrc_MeanSquaredError: 0.0604 - movedSegm_sigmoid_sftDC: 0.1689 - srcSegm_sigmoid_DC: 0.1675 - nonr_def_mean_absolute_error: 0.0649
12/17 [====================>.........] - ETA: 1:24:00 - loss: 0.0222 - warpedSrc_loss: 0.0580 - movedSegm_loss: -0.0894 - srcSegm_loss: -0.0889 - nonr_def_loss: 4.0234e-04 - warpedSrc_MeanSquaredError: 0.0580 - movedSegm_sigmoid_sftDC: 0.1733 - srcSegm_sigmoid_DC: 0.1716 - nonr_def_mean_absolute_error: 0.0661
13/17 [=====================>........] - ETA: 1:07:12 - loss: 0.0066 - warpedSrc_loss: 0.0557 - movedSegm_loss: -0.0908 - srcSegm_loss: -0.0906 - nonr_def_loss: 4.1628e-04 - warpedSrc_MeanSquaredError: 0.0557 - movedSegm_sigmoid_sftDC: 0.1783 - srcSegm_sigmoid_DC: 0.1773 - nonr_def_mean_absolute_error: 0.0669
14/17 [=======================>......] - ETA: 50:24 - loss: 4.8958e-04 - warpedSrc_loss: 0.0552 - movedSegm_loss: -0.0920 - srcSegm_loss: -0.0917 - nonr_def_loss: 4.2866e-04 - warpedSrc_MeanSquaredError: 0.0552 - movedSegm_sigmoid_sftDC: 0.1831 - srcSegm_sigmoid_DC: 0.1819 - nonr_def_mean_absolute_error: 0.0675
15/17 [=========================>....] - ETA: 33:36 - loss: -0.0134 - warpedSrc_loss: 0.0533 - movedSegm_loss: -0.0935 - srcSegm_loss: -0.0931 - nonr_def_loss: 4.4229e-04 - warpedSrc_MeanSquaredError: 0.0533 - movedSegm_sigmoid_sftDC: 0.1888 - srcSegm_sigmoid_DC: 0.1872 - nonr_def_mean_absolute_error: 0.0684   
16/17 [===========================>..] - ETA: 16:48 - loss: -0.0157 - warpedSrc_loss: 0.0536 - movedSegm_loss: -0.0948 - srcSegm_loss: -0.0943 - nonr_def_loss: 4.5876e-04 - warpedSrc_MeanSquaredError: 0.0536 - movedSegm_sigmoid_sftDC: 0.1945 - srcSegm_sigmoid_DC: 0.1929 - nonr_def_mean_absolute_error: 0.0692
17/17 [==============================] - 18414s 1083s/step - loss: -0.0267 - warpedSrc_loss: 0.0521 - movedSegm_loss: -0.0960 - srcSegm_loss: -0.0955 - nonr_def_loss: 4.7360e-04 - warpedSrc_MeanSquaredError: 0.0521 - movedSegm_sigmoid_sftDC: 0.2004 - srcSegm_sigmoid_DC: 0.1986 - nonr_def_mean_absolute_error: 0.0705 - val_loss: 0.5069 - val_warpedSrc_loss: 0.1365 - val_movedSegm_loss: -0.0589 - val_srcSegm_loss: -0.0582 - val_nonr_def_loss: 0.0136 - val_warpedSrc_MeanSquaredError: 0.1365 - val_movedSegm_sigmoid_sftDC: 0.0676 - val_srcSegm_sigmoid_DC: 0.0664 - val_nonr_def_mean_absolute_error: 1.2831

Epoch 00001: val_srcSegm_sigmoid_DC improved from -inf to 0.06644, saving model to /home/groups/dlmrimnd/jacob/data/results/accWeights.01-0.51.hdf5

Epoch 00001: val_movedSegm_sigmoid_sftDC improved from -inf to 0.06758, saving model to /home/groups/dlmrimnd/jacob/data/results/consWeights.01-0.51.hdf5

Epoch 00001: saving model to /home/groups/dlmrimnd/jacob/data/results/model_weight_out.h5
lr:  0.0005
loss weight lamda used:  9.0
